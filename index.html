<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–µ–ø–æ–π –ø–µ—á–∞—Ç–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }

        .text-display {
            background: #f8f9fa;
            padding: 30px 30px 40px 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 1.8em;
            line-height: 2.2;
            font-family: 'Monaco', 'Courier New', monospace;
            min-height: 120px;
            letter-spacing: 2px;
        }

        .char {
            transition: all 0.1s ease;
            display: inline-block;
            position: relative;
        }

        .char .eng-hint {
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.5em;
            color: #999;
            opacity: 0.4;
            pointer-events: none;
        }

        .char.correct {
            color: #10b981;
            background: #d1fae5;
        }

        .char.incorrect {
            color: #ef4444;
            background: #fee2e2;
        }

        .char.current {
            background: #fbbf24;
            animation: pulse 1s infinite;
        }
        
        .char.current .eng-hint {
            opacity: 0.7;
            color: #666;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .input-area {
            margin-bottom: 20px;
        }

        input {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        button {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .reset-btn {
            background: #e5e7eb;
            color: #333;
        }

        .reset-btn:hover {
            background: #d1d5db;
        }

        .level-selector {
            margin-bottom: 20px;
            text-align: center;
        }

        .level-selector label {
            font-size: 1.1em;
            margin-right: 10px;
            color: #333;
            font-weight: 600;
        }

        .level-selector select {
            padding: 10px 20px;
            font-size: 1em;
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: pointer;
            background: white;
        }

        .finished {
            text-align: center;
            padding: 20px;
            background: #d1fae5;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .finished h2 {
            color: #10b981;
            margin-bottom: 10px;
        }

        .keyboard-hint {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚å®Ô∏è –¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–µ–ø–æ–π –ø–µ—á–∞—Ç–∏</h1>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">–°–∫–æ—Ä–æ—Å—Ç—å</div>
                <div class="stat-value" id="wpm">0</div>
                <div class="stat-label">–∑–Ω/–º–∏–Ω</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                <div class="stat-value" id="accuracy">100%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">–í—Ä–µ–º—è</div>
                <div class="stat-value" id="timer">0</div>
                <div class="stat-label">—Å–µ–∫</div>
            </div>
        </div>

        <div class="level-selector">
            <label for="level">–£—Ä–æ–≤–µ–Ω—å:</label>
            <select id="level">
                <option value="easy">–õ–µ–≥–∫–∏–π (—Å—Ä–µ–¥–Ω–∏–π —Ä—è–¥)</option>
                <option value="medium">–°—Ä–µ–¥–Ω–∏–π (+ –≤–µ—Ä—Ö–Ω–∏–π —Ä—è–¥)</option>
                <option value="hard">–°–ª–æ–∂–Ω—ã–π (–≤—Å–µ –±—É–∫–≤—ã)</option>
                <option value="punctuation">–ó–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è</option>
                <option value="symbols">–°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã –∏ —Å–∫–æ–±–∫–∏</option>
                <option value="expert">–≠–∫—Å–ø–µ—Ä—Ç (—Å —Ü–∏—Ñ—Ä–∞–º–∏)</option>
            </select>
        </div>

        <div class="keyboard-hint">üí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤–∫–ª—é—á–∏—Ç—å —Ä—É—Å—Å–∫—É—é —Ä–∞—Å–∫–ª–∞–¥–∫—É!</div>

        <div class="text-display" id="textDisplay">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å"</div>

        <div class="input-area">
            <input type="text" id="textInput" placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–µ—á–∞—Ç–∞—Ç—å..." disabled>
        </div>

        <div class="buttons">
            <button class="start-btn" id="startBtn" onclick="startGame()">–ù–∞—á–∞—Ç—å</button>
            <button class="reset-btn" onclick="resetGame()">–°–±—Ä–æ—Å</button>
        </div>
    </div>

    <script>
        const texts = {
            easy: [
                '—ã–≤–∞ –æ–ª–¥ —Ñ—ã–≤ –∞–ø—Ä –∂–¥—ã',
                '—Ñ—ã–≤ —ã–≤–∞ –∞–ø—Ä –æ–ª–¥ –∂–¥—ã',
                '–¥–æ–º –ª–µ—Å —Å–∞–¥ –≤–æ–¥–∞',
                '—Ä—É–∫–∞ –Ω–æ–≥–∞ –¥–µ–ª–æ –ø–∞–ø–∞',
                '–º–∞–º–∞ –∫–∞—à–∞ —Å–æ–ª—å —Å–∞–ª–æ',
                '–ø–æ—Ä–∞ –∏–¥—Ç–∏ —Å–ø–∞—Ç—å –¥–Ω—ë–º',
                '–æ–∫–Ω–æ –¥–≤–µ—Ä—å —Å—Ç–æ–ª —Å—Ç—É–ª',
                '–ª–∞–ø–∞ –ª–∞–º–∞ –¥–∞–º–∞ —Ä–∞–º–∞',
                '—Å–æ–≤–∞ —Ä–æ—Å–∞ –∫–æ—Å–∞ –æ—Å–∞',
                '–º—ã–ª–æ –º—É–∫–∞ –ª—É–∂–∞ –º–æ—Ä–µ',
                '–∫–∞—à–∞ —Ä—ã–±–∞ —Å—É–ø —Å–∞–ª–∞—Ç',
                '–ø–∞–ø–∞ –º–∞–º–∞ —Å—ã–Ω –¥–æ—á—å',
                '–≤–æ–ª–∫ –ª–∏—Å–∞ –∑–∞—è—Ü —Å–ª–æ–Ω',
                '–¥–µ–Ω—å –Ω–æ—á—å —É—Ç—Ä–æ –≤–µ—á–µ—Ä',
                '–Ω–µ–±–æ –∑–µ–º–ª—è –≤–æ–¥–∞ –æ–≥–æ–Ω—å'
            ],
            medium: [
                '–±—ã—Å—Ç—Ä–æ –ø–µ—á–∞—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç',
                '—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',
                '—Ç–æ—á–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏',
                '—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –¥–µ–ª–∞–µ—Ç –º–∞—Å—Ç–µ—Ä–∞',
                '—Å–ª–µ–ø–æ–π –º–µ—Ç–æ–¥ –ø–µ—á–∞—Ç–∏',
                '–ø—Ä–∞–∫—Ç–∏–∫–∞ –≤–µ–¥—ë—Ç –∫ —É—Å–ø–µ—Ö—É',
                '—Ç–µ—Ä–ø–µ–Ω–∏–µ –∏ —Ç—Ä—É–¥ –≤—Å—ë –ø–µ—Ä–µ—Ç—Ä—É—Ç',
                '–∑–Ω–∞–Ω–∏–µ —ç—Ç–æ —Å–∏–ª–∞ —Ä–∞–∑—É–º–∞',
                '—É—á–∏—Ç—å—Å—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∑–¥–Ω–æ',
                '–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –º–∞—Ç—å —É—á–µ–Ω–∏—è',
                '–¥–æ—Ä–æ–≥—É –æ—Å–∏–ª–∏—Ç –∏–¥—É—â–∏–π',
                '–≤—Ä–µ–º—è –ª—É—á—à–∏–π —É—á–∏—Ç–µ–ª—å',
                '–æ–ø—ã—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –≥–æ–¥–∞–º–∏',
                '—Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ —Å–æ–±–æ–π –≤–∞–∂–Ω–∞',
                '—Ä–∞–∑–≤–∏—Ç–∏–µ –Ω–∞–≤—ã–∫–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏'
            ],
            hard: [
                '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫–∏',
                '–æ—Å–≤–æ–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–µ—Å–ª–æ–∂–Ω–æ',
                '—Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—á–∞—Ç–∏ —Ä–∞—Å—Ç–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ',
                '–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞–≤–∞–π —É—á–∏—Ç—å—Å—è',
                '—Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ',
                '–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç',
                '–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —É–ø–æ—Ä—Å—Ç–≤–æ',
                '—Ä–∞–∑–≤–∏–≤–∞–π—Ç–µ —Å–≤–æ–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏',
                '–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏',
                '–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É',
                '—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≤—ã–∫–æ–≤',
                '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –º–µ–Ω—è—é—Ç –Ω–∞—à –º–∏—Ä –µ–∂–µ–¥–Ω–µ–≤–Ω–æ',
                '—Ü–∏—Ñ—Ä–æ–≤–∞—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –≤—Å–µ–º',
                '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–æ—â–∞–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏',
                '–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–≥–æ —Ç—Ä—É–¥–∞'
            ],
            punctuation: [
                '–ø—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞? –æ—Ç–ª–∏—á–Ω–æ!',
                '–æ–¥–∏–Ω, –¥–≤–∞, —Ç—Ä–∏, —á–µ—Ç—ã—Ä–µ.',
                '–≥–¥–µ? –∫–æ–≥–¥–∞? –ø–æ—á–µ–º—É? –∫–∞–∫?',
                '—Å—Ç–æ–ø! –≤–Ω–∏–º–∞–Ω–∏–µ! –≤–∞–∂–Ω–æ!',
                '–¥–∞, –Ω–µ—Ç, –º–æ–∂–µ—Ç –±—ã—Ç—å.',
                '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! —Ä–∞–¥ –≤–∞—Å –≤–∏–¥–µ—Ç—å.',
                '—á—Ç–æ? –∫–æ–≥–¥–∞? –≥–¥–µ? –∑–∞—á–µ–º?',
                '—Ö–æ—Ä–æ—à–æ, –æ—Ç–ª–∏—á–Ω–æ, —Å—É–ø–µ—Ä!',
                '–ø–æ–Ω—è—Ç–Ω–æ. —Å–æ–≥–ª–∞—Å–µ–Ω. –ø—Ä–∏–Ω—è—Ç–æ.',
                '–≤–æ–ø—Ä–æ—Å: –æ—Ç–≤–µ—Ç. —Ä–µ—à–µ–Ω–∏–µ: –¥–∞.',
                '—É—Ç—Ä–æ, –¥–µ–Ω—å, –≤–µ—á–µ—Ä, –Ω–æ—á—å.',
                '—Ç–æ—á–Ω–æ! –≤–µ—Ä–Ω–æ! –ø—Ä–∞–≤–∏–ª—å–Ω–æ!',
                '—è—Å–Ω–æ? –ø–æ–Ω—è–ª? —É—Å–≤–æ–∏–ª?',
                '–∫—Ä–∞—Å–∏–≤–æ, —è—Ä–∫–æ, –≤–µ—Å–µ–ª–æ!',
                '–≤–Ω–∏–º–∞–Ω–∏–µ: –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.'
            ],
            symbols: [
                '—Å–∫–æ–±–∫–∏: (–æ–¥–∏–Ω) [–¥–≤–∞] {—Ç—Ä–∏}',
                '–∫–∞–≤—ã—á–∫–∏: "—Ç–µ–∫—Å—Ç" –∏ –µ—â—ë',
                '—Å–∏–º–≤–æ–ª—ã: @ # $ % & *',
                'math: 2 + 2 = 4, 10 - 5',
                '–∫–æ–¥: function() { return; }',
                'email: user@example.com',
                '—Ü–µ–Ω–∞: $100 –∏–ª–∏ 50%',
                '—Ç–µ–≥–∏: <div> #hashtag @mention',
                '—Ñ–æ—Ä–º—É–ª–∞: (a + b) * (c - d)',
                '–ø—É—Ç—å: /home/user/folder/',
                '–æ–ø–µ—Ä–∞—Ü–∏–∏: 5 * 3 / 2 + 1',
                '–º–∞—Å—Å–∏–≤: [1, 2, 3, 4, 5]',
                '–æ–±—ä–µ–∫—Ç: {name: "test"}',
                '—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ: x > 5 && y < 10',
                '—Å—Ç—Ä–æ–∫–∞: "hello" + "world"'
            ],
            expert: [
                '–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —á–∏—Å–ª–æ = 42 –ø–ª—é—Å 10',
                '—Ñ—É–Ω–∫—Ü–∏—è —Å–ª–æ–∂–∏—Ç—å —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 100',
                '–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –ø–∏ = 3.14159 —Ä–∞–¥–∏—É—Å 15',
                '—Ü–∏–∫–ª –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞ –æ—Ç 0 –¥–æ 20',
                '—É—Å–ª–æ–≤–∏–µ –µ—Å–ª–∏ —Ö –±–æ–ª—å—à–µ 5 —Ç–æ –∏—Å—Ç–∏–Ω–∞',
                '–º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç 256 —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
                '–∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∑–∞ –≤—Ä–µ–º—è n log n',
                '—Ä–µ–∫—É—Ä—Å–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∞–º—É —Å–µ–±—è 10 —Ä–∞–∑',
                '–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ–≤—ã—à–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –≤ 2 —Ä–∞–∑–∞',
                '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç 1000000 –∑–∞–ø–∏—Å–µ–π',
                '—Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥—ã',
                '–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ö —Ä–∞–≤–Ω–∞ 100 —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ 5',
                '—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Å 3 —Å–≤–æ–π—Å—Ç–≤–∞–º–∏',
                '–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ 50 —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
                '–≤—ã—á–∏—Å–ª–∏—Ç—å —Å—É–º–º—É –æ—Ç 1 –¥–æ 999'
            ]
        };

        const ruToEng = {
            '–∞': 'f', '–±': ',', '–≤': 'd', '–≥': 'u', '–¥': 'l', '–µ': 't', '—ë': '`',
            '–∂': ';', '–∑': 'p', '–∏': 'b', '–π': 'q', '–∫': 'r', '–ª': 'k', '–º': 'v',
            '–Ω': 'y', '–æ': 'j', '–ø': 'g', '—Ä': 'h', '—Å': 'c', '—Ç': 'n', '—É': 'e',
            '—Ñ': 'a', '—Ö': '[', '—Ü': 'w', '—á': 'x', '—à': 'i', '—â': 'o', '—ä': ']',
            '—ã': 's', '—å': 'm', '—ç': '\'', '—é': '.', '—è': 'z', ' ': 'space',
            ',': ',', '.': '.', '!': '!', '?': '?', ':': ':', ';': ';',
            '-': '-', '=': '=', '+': '+', '_': '_',
            '(': '(', ')': ')', '[': '[', ']': ']', '{': '{', '}': '}',
            '"': '"', '\'': '\'', '@': '@', '#': '#', '$': '$', '%': '%',
            '&': '&', '*': '*', '/': '/', '\\': '\\'
        };

        let currentText = '';
        let currentIndex = 0;
        let startTime = null;
        let timerInterval = null;
        let errors = 0;
        let totalChars = 0;

        const textDisplay = document.getElementById('textDisplay');
        const textInput = document.getElementById('textInput');
        const startBtn = document.getElementById('startBtn');
        const levelSelect = document.getElementById('level');

        function getEngHint(ruChar) {
            const hint = ruToEng[ruChar.toLowerCase()];
            if (hint === 'space') return '‚ê£';
            return hint || '';
        }

        function getRandomText() {
            const level = levelSelect.value;
            const textArray = texts[level];
            return textArray[Math.floor(Math.random() * textArray.length)];
        }

        function displayText() {
            textDisplay.innerHTML = currentText.split('').map((char, index) => {
                let className = 'char';
                if (index < currentIndex) {
                    className += ' correct';
                } else if (index === currentIndex) {
                    className += ' current';
                }
                const engHint = getEngHint(char);
                const hintSpan = engHint ? `<span class="eng-hint">${engHint}</span>` : '';
                return `<span class="${className}">${char}${hintSpan}</span>`;
            }).join('');
        }

        function startGame() {
            currentText = getRandomText();
            currentIndex = 0;
            errors = 0;
            totalChars = 0;
            startTime = Date.now();
            
            textInput.value = '';
            textInput.disabled = false;
            textInput.focus();
            
            startBtn.disabled = true;
            levelSelect.disabled = true;
            
            displayText();
            
            timerInterval = setInterval(updateTimer, 100);
        }

        function resetGame() {
            clearInterval(timerInterval);
            
            if (currentText) {
                textInput.disabled = true;
                startBtn.disabled = false;
                levelSelect.disabled = false;
            }
            
            currentText = '';
            currentIndex = 0;
            errors = 0;
            totalChars = 0;
            startTime = null;
            
            textInput.value = '';
            textInput.disabled = true;
            textDisplay.innerHTML = '–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å"';
            
            startBtn.disabled = false;
            levelSelect.disabled = false;
            
            document.getElementById('wpm').textContent = '0';
            document.getElementById('accuracy').textContent = '100%';
            document.getElementById('timer').textContent = '0';
        }

        function updateTimer() {
            if (startTime) {
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                document.getElementById('timer').textContent = elapsed;
                updateWPM();
            }
        }

        function updateWPM() {
            if (startTime && totalChars > 0) {
                const minutes = (Date.now() - startTime) / 60000;
                const wpm = Math.round((totalChars / 5) / minutes);
                document.getElementById('wpm').textContent = wpm || 0;
            }
        }

        function updateAccuracy() {
            if (totalChars > 0) {
                const accuracy = Math.round(((totalChars - errors) / totalChars) * 100);
                document.getElementById('accuracy').textContent = accuracy + '%';
            }
        }

        function finishGame() {
            clearInterval(timerInterval);
            
            const finalTime = ((Date.now() - startTime) / 1000).toFixed(1);
            const accuracy = Math.round(((totalChars - errors) / totalChars) * 100);
            
            const finishedMsg = document.createElement('div');
            finishedMsg.className = 'finished';
            finishedMsg.innerHTML = `
                <h2>üéâ –û—Ç–ª–∏—á–Ω–æ!</h2>
                <p>–í—Ä–µ–º—è: ${finalTime} —Å–µ–∫ | –¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy}%</p>
                <p style="font-size: 0.9em; margin-top: 10px; color: #666;">–ó–∞–≥—Ä—É–∂–∞—é –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç...</p>
            `;
            
            textDisplay.parentNode.insertBefore(finishedMsg, textDisplay);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                finishedMsg.remove();
                startGame();
            }, 1500);
        }

        textInput.addEventListener('input', (e) => {
            if (!currentText || currentText.length === 0) {
                return;
            }
            
            const typed = e.target.value;
            const lastChar = typed[typed.length - 1];
            
            if (currentIndex < currentText.length) {
                totalChars++;
                
                if (lastChar === currentText[currentIndex]) {
                    currentIndex++;
                    displayText();
                    
                    if (currentIndex === currentText.length) {
                        finishGame();
                    }
                } else {
                    errors++;
                }
                
                updateAccuracy();
                updateWPM();
            }
        });

        levelSelect.addEventListener('change', resetGame);

        resetGame();
    </script>
</body>
</html>
